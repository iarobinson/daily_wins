<div class="container">
  <div class="row">
    <div class="col">
      <div class="text-center">
          <h2 class="pt-3"><%= title %></h2>
      </div>
    </div>
  </div>
  <div class="row">
    <% if @challenges.count > 0 %>
      <div class="card m-3">
        <div class="table-responsive">
          <table class="table">
            <thead>
              <tr>
                <th></th>
                <th>Title</th>
                <th>Description</th>
                <th>Wins</th>
                <th colspan="3">Manage</th>
              </tr>
            </thead>

            <tbody>
              <% @challenges.reverse.each do |challenge| %>
                <tr>
                  <td>
                    <%= image_tag "default_avatar.jpg", width: "50px", class: "img-rounded" unless challenge.primary_image.attached? %>
                    <%= image_tag challenge.primary_image, width: "50px", class: "img-rounded" if challenge.primary_image.attached? %>
                  </td>
                  <td><%= challenge.title %></td>
                  <td><%= challenge.description %></td>
                  <td><%= challenge.wins.size %></td>
                  <td>
                    <% if current_user.challenges.include?(challenge) %>
                      <%= link_to 'Leave', challenge_leave_path(challenge), class: "btn btn-block btn-primary" %>
                    <% else %>
                      <%= link_to 'Join', challenge_join_path(challenge), class: "btn btn-block btn-primary" %>
                    <% end %>
                  </td>
                  <td><%= link_to 'Show', challenge, class: "btn btn-block btn-primary" %></td>
                  <!-- <td><#%= link_to 'Edit', edit_challenge_path(challenge), class: "btn btn-block btn-primary" %></td> -->
                  <!-- <td><#%= link_to 'Destroy', challenge, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-block btn-primary" %></td> -->
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
      <%= link_to 'Create a New Challenge', new_challenge_path, class: "btn btn-block btn-primary m-3" %>
    <% else %>
      <div class="col">
        <p class="text-center">You're not currently participating in a challenge.</p>
        <%= link_to "Join a Challenge", challenges_path, class: "btn btn-block btn-success" %>
        <%= link_to 'Create a New Challenge', new_challenge_path, class: "btn btn-block btn-primary" %>
      </div>
    <% end %>
  </div>
</div>
